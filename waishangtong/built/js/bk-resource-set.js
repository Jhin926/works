require(["common"],function(){require(["maintab","blockUI","jqueryUI","evol","datetimepickerCN","category","countries"],function(t){function e(){$("#"+m+"-info-set-add").unbind("click").click(function(){var t='<li data-type="1" data-isAdd="yes"><input type="text" class="resource-input" name="" value="新字段"><input type="checkbox" checked="true"> 必填 <i class="group-remove '+m+'-info-set-del"></li>';$("#"+m+"-info-set ul").append(t),$("#"+m+"-info-set ul input:checkbox").uniform()}),$("#"+m+"-info-set").unbind("click").on("click","."+m+"-info-set-del",function(){var t=$(this).parent(),e=t.attr("data-isAdd");console.log("no"==e),"no"==e?t.attr("data-type","2").css("display","none"):t.remove()}),$("#"+m+"-info-set").unbind("change").on("change","input:text, input:checkbox",function(){var t=$(this).parents("li");t.attr("data-isEdt","yes")}),$("#"+m+"-info-set-save").unbind("click").click(function(){var t={attributes:[]};$("#"+m+"-info-set ul").children("li").each(function(){var e={},a={},i={},s=$(this).attr("data-type");if("1"==s){e.type=1,e.bizType=y,e.name=$(this).find("input:text").val(),e.required=$(this).find("input:checkbox").prop("checked")?1:0,e.inputType=1,e.length=$(this).find("input:text").val().length,e.status=1,t.attributes.push(e);var n=$(this).find("input:text")[0];$(".client-info-ul").find("li input:text").each(function(e){if(n!=this&&$(this).val()==$(n).val())return $.Alert("新字段不能重名！"),t.attributes=[],!1})}else"2"==s?(i.id=$(this).attr("data-id"),i.type=2,i.bizType=y,i.name=$(this).find("input:text").val(),i.required=$(this).find("input:checkbox").prop("checked")?1:0,i.inputType=1,i.length=$(this).find("input:text").val().length,i.status=1,t.attributes.push(i)):"3"==s?"yes"==$(this).attr("data-isEdt")&&(a.id=$(this).attr("data-id"),a.type=3,a.bizType=y,a.name=$(this).find("input:text").val(),a.required=$(this).find("input:checkbox").prop("checked")?1:0,a.inputType=1,a.length=$(this).find("input:text").val().length,a.status=1,t.attributes.push(a)):"yes"==$(this).attr("data-isEdt")&&(a.id=$(this).attr("data-id"),a.type=3,a.bizType=y,a.name=$(this).find("input:text").val(),a.required=$(this).find("input:checkbox").prop("checked")?1:0,a.inputType=1,a.length=$(this).find("input:text").val().length,a.status=1,t.attributes.push(a))}),t.attributes.length>0?$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/defined/attribute/edit",data:{data:JSON.stringify(t)},dataType:"json",type:"GET",success:function(t){t.success?$.Alert("保存成功！"):$.Alert("保存失败！")}}):$.Alert("没做任何修改！")})}function a(){$("#"+m+"-info-set ul").children("li").remove(),$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/defined/attribute/list",data:{data:JSON.stringify({bizType:y})},dataType:"json",type:"GET",success:function(t){if(!t.success)return void alert(t.message);for(var a=t.data,i=0;i<a.length;i++){var s=a[i],n="";n=s.status==-1?0==s.required?'<li data-isAdd="no" data-id="'+a[i].id+'"><input type="text" class="resource-input" name="" value="'+a[i].name+'" disabled><input type="checkbox" disabled> 必填</li>':'<li data-isAdd="no" data-id="'+a[i].id+'"><input type="text" class="resource-input" name="" value="'+a[i].name+'" disabled><input type="checkbox" checked="true" disabled> 必填</li>':0==s.required?0==s.removable?'<li data-type="3" data-isEdt="no" data-id="'+a[i].id+'" data-isAdd="no"><input type="text" class="resource-input" name="" value="'+a[i].name+'" disabled><input type="checkbox" > 必填 </li>':'<li data-type="3" data-isEdt="no" data-id="'+a[i].id+'" data-isAdd="no"><input type="text" class="resource-input" name="" value="'+a[i].name+'"><input type="checkbox" > 必填 <i class="group-remove '+m+'-info-set-del"></li>':0==s.removable?'<li data-type="3" data-isEdt="no" data-id="'+a[i].id+'" data-isAdd="no"><input type="text" class="resource-input" name="" value="'+a[i].name+'"disabled><input type="checkbox" checked="true" > 必填</li>':'<li data-type="3" data-isEdt="no" data-id="'+a[i].id+'" data-isAdd="no"><input type="text" class="resource-input" name="" value="'+a[i].name+'"><input type="checkbox" checked="true" > 必填 <i class="group-remove '+m+'-info-set-del"></li>',"order_no"==a[i].code&&3==y&&(n=""),$("#"+m+"-info-set ul").append(n)}$("#"+m+"-info-set ul input:checkbox").uniform(),e()}})}function i(){$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/limit/customer/list",dataType:"json",type:"POST",success:function(t){if(!t.success)return void alert(t.message);for(var e=t.data,a="",i=0;i<e.length;i++)a+='<tr data-id="'+e[i].id+'"><td width="20%" data-uerId="'+e[i].userId+'"><label class="blue">'+e[i].userName+'</label></td><td width="20%" data-dep="'+e[i].department+'">'+e[i].departmentName+'</td><td width="20%">'+e[i].currentNumber+'</td><td width="20%"><input type="text" class="table-input" value="'+e[i].upperLimit+'"></td></tr>';$("#client-up .table tbody").empty().append(a)}})}function s(){$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/customer/source/list",dataType:"json",type:"POST",success:function(t){if(!t.success)return void alert(t.message);for(var e=t.data,a="",i=0;i<e.length;i++)a+='<li data-id="'+e[i].id+'" data-type=""><i class="group-move"></i><input type="text" class="resource-input" value="'+e[i].name+'" placeholder=""> <i class="group-remove"></i></li>';$("#client-source ul").empty().append(a)}})}function n(){$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/customer/blacklist/list",dataType:"json",type:"GET",success:function(t){if(!t.success)return void alert(t.message);for(var e=t.data,a="",i=0;i<e.length;i++)a+='<li data-id="'+e[i].id+'" data-isDel="'+e[i].isDel+'" data-type=""><input type="text" class="resource-input" name="" value="'+e[i].email+'"><i class="group-remove"></i></li>';$("#blacklist-set ul").empty().append(a)}})}function l(){$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/customer/status/list",dataType:"json",type:"POST",success:function(t){if(!t.success)return void alert(t.message);for(var e=t.data,a="",i=0;i<e.length;i++){var s=e[i].name.substring(0,1);a+='<li data-id="'+e[i].id+'" data-type=""><i class="group-move"></i><a href="#" class="color-show status-label" style="background:'+e[i].colour+'">'+s+'</a><input class="cpOther" value="'+e[i].colour+'" /><input type="text" class="resource-input" value="'+e[i].name+'" placeholder=""> <i class="group-remove"></i></li>'}$("#status-set ul").empty().append(a)}})}function r(){$("#group-set ul").children("li").remove(),$.ajax({url:Base.sitUrl+"/api/customer/v1/customer/group/list",dataType:"json",type:"POST",success:function(t){if(!t.success)return void alert(t.message);var e=t.data;e.length>0&&$("#group-set-save").show();for(var a=0;a<e.length;a++){var i=(e[a].name.substring(0,1),'<li data-id="'+e[a].id+'" data-type="" data-totalCount="'+e[a].totalCount+'"><i class="group-move"></i><input type="text" class="resource-input" value="'+e[a].name+'" placeholder=""> <i class="group-remove"></i></li>');$("#group-set ul").append(i)}}})}function o(){$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/settinghighseas/list",dataType:"json",type:"POST",success:function(t){if(!t.success)return void alert(t.message);var e=t.data;$("#client-public").attr("data-id",e.id),$("#daysNoCC").val(e.conditionI),$("#daysNoCh").val(e.conditionII),$("#clientEachDay").val(e.dayUpperLimit)}})}function c(t){function e(a){for(var i in a){if(t.val()===i){if(t.nextAll("select").remove(),void 0!=a[i].sub){var s=$('<select class="form-control"></select>'),n='<option value="0">请选择</option>';for(var l in a[i].sub)n+='<option value="'+l+'">'+a[i].sub[l].cn_name+"</option>";s.on("change",function(){c(s)}),t.after(s.append(n))}break}void 0!=a[i].sub&&e(a[i].sub)}}0!=t.val()?(e(category),k.productType=t.val()):t.nextAll("select").remove()}function u(){$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/list",type:"POST",dataType:"json",success:function(t){if(!t.success)return void $.unLogin(t);var e=t.data,a="";if(e.length>0)for(var i=0;i<e.length;i++){var s=e[i].name||"匿名";s.length>13&&(s=s.slice(0,10)+"..."),a+='<option value="'+e[i].id+'">'+s+"</option>"}$("#follower").append(a)}})}function d(){$.ajax({url:Base.sitUrl+"/api/customer/v1/customer/group/list",type:"POST",success:function(t){if(!t.success)return void $.unLogin(t);for(var e=t.data,a="",i=0;i<e.length;i++)a+='<option value="'+e[i].id+'">'+e[i].name+"</option>";$("#group-list").append(a)}})}function p(){$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/customer/source/list",type:"POST",async:!1,dataType:"json",success:function(t){if(!t.success)return void $.unLogin(t);for(var e=t.data,a="",i=0;i<e.length;i++)a+='<option value="'+e[i].id+'">'+e[i].name+"</option>";$("#source-list").append(a)}})}function f(){$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/customer/status/list",type:"POST",dataType:"json",success:function(t){if(!t.success)return void $.unLogin(t);for(var e=t.data,a="",i=0;i<e.length;i++)a+='<option value="'+e[i].id+'">'+e[i].name+"</option>";$("#status-list").append(a)}})}function v(){$.ajax({url:Base.sitUrl+"/api/sys/v1/sys/dictionary/get",type:"POST",data:{group:"customer.type"},dataType:"json",success:function(t){if(!t.success)return void $.unLogin(t);for(var e=t.data,a="",i=0;i<e.length;i++)a+='<option value="'+e[i].id+'">'+e[i].value+"</option>";$("#type-list").append(a)}})}var h=top.funcList;$("[data-code]").each(function(){for(var t=0;t<h.length;t++)h[t].code==$(this).attr("data-code")&&$(this).removeClass("none")}),jQuery().datetimepicker&&$(".datetime-picker").datetimepicker({language:"zh-CN",todayBtn:1,autoclose:1,todayHighlight:1,startView:2,minView:2,format:"yyyy-mm-dd",bootcssVer:3}),$(document).on("click",".color-show",function(t){$(this).parents("li").find(".cpOther").colorpicker({showOn:"none"}),t.stopImmediatePropagation(),$(this).parents("li").find(".cpOther").colorpicker("showPalette"),$(this).parents("li").find(".cpOther").on("change.color",function(t,e){$(this).parents("li").find(".color-show").css("background-color",e)})});var g=location.href,y=1,m="client";g.indexOf("bk-resource-lm")>0?(y=2,m="contacts",a()):g.indexOf("bk-resource-ofInfo")>0?(y=3,m="order",a()):(y=1,m="client",$("#client-info-set-li").on("click",a)),$("#group-set-li").on("click",function(){$(this).children(".panel-left-label").addClass("active"),$(this).siblings().find(".panel-left-label").removeClass("active"),$("#group-set").show().siblings(".panel-body").hide()}),$("#client-up-li").on("click",function(){$(this).children(".panel-left-label").addClass("active"),$(this).siblings().find(".panel-left-label").removeClass("active"),$("#client-up").show().siblings(".panel-body").hide(),i()}),$("#client-source-li").on("click",function(){$(this).children(".panel-left-label").addClass("active"),$(this).siblings().find(".panel-left-label").removeClass("active"),$("#client-source").show().siblings(".panel-body").hide(),s()}),$("#blacklist-set-li").on("click",function(){$(this).children(".panel-left-label").addClass("active"),$(this).siblings().find(".panel-left-label").removeClass("active"),$("#blacklist-set").show().siblings(".panel-body").hide(),n()}),$("#client-info-set-li").on("click",function(){$(this).children(".panel-left-label").addClass("active"),$(this).siblings().find(".panel-left-label").removeClass("active"),$("#client-info-set").show().siblings(".panel-body").hide()}),$("#status-set-li").on("click",function(){$(this).children(".panel-left-label").addClass("active"),$(this).siblings().find(".panel-left-label").removeClass("active"),$("#status-set").show().siblings(".panel-body").hide(),l()}),$("#client-public-li").on("click",function(){$(this).children(".panel-left-label").addClass("active"),$(this).siblings().find(".panel-left-label").removeClass("active"),$("#client-public").show().siblings(".panel-body").hide(),o()}),$("#output-cust-li").on("click",function(){$(this).children(".panel-left-label").addClass("active"),$(this).siblings().find(".panel-left-label").removeClass("active"),$("#output-cust").show().siblings(".panel-body").hide()});var b=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;String.prototype.colorHex=function(){var t=this;if(/^(rgb|RGB)/.test(t)){for(var e=t.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),a="#",i=0;i<e.length;i++){var s=Number(e[i]).toString(16);"0"===s&&(s+=s),a+=s}return 7!==a.length&&(a=t),a}if(!b.test(t))return t;var n=t.replace(/#/,"").split("");if(6===n.length)return t;if(3===n.length){for(var l="#",i=0;i<n.length;i+=1)l+=n[i]+n[i];return l}},$(".addGoup").on("click",function(){var t='<li data-id="" data-type="1" data-totalCount=""><i class="group-move"></i><a href="#" class="color-show status-label" style="background:blue">无</a><input class="cpOther" value="" /><input type="text" class="resource-input" name=""><label class="label-checkbox"><div class="checker"><span class="checked"><input type="checkbox" checked="true"></span></div> 必填</label> <i class="group-remove"></i></li>';$(this).prev("ul").append(t)}),$("#client-up-save").on("click",function(){for(var t=$("#client-up .table tbody").children("tr"),e="",a="",s=0;s<t.length;s++){var n=t.eq(s).find("input[type=text]").val(),l=t.eq(s).find("td:nth-child(3)").text();if(l=parseInt(l),n<l)return void $.Alert("客户上限数必须大于等于目前客户数");if(isNaN(n))return $.Alert("请填写数字！"),void t.eq(s).find("input[type=text]").css("border","1px solid red");e+='{"key":"'+t.eq(s).data("id")+'","value":"'+n+'","type":"3"},'}e=e.substr(0,e.length-1),a='{"keyValueTypes":['+e+"]}",$.Confirm("确认保存？","",function(){$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/limit/customer/edit",dataType:"json",type:"POST",data:{data:a},success:function(t){return t.success?($.Alert("保存成功！"),void i()):void alert(t.message)}})})}),$("#client-source").on("click",".group-remove",function(){var t=$(this),e=parseInt($(this).parents("li").attr("data-totalCount"));e>0?$.Alert("此来源中有关联信息,请取消后删除"):$.Confirm("确认删除？","",function(){t.parent().hide().attr("data-type","2")})}),$("#client-source-save").on("click",function(){for(var t=$("#client-source ul").children("li"),e="",a="",i="",n=0;n<t.length;n++){var l=t.eq(n).find("input[type=text]").val();if($.GetLength(l)>64)return void $.Alert("请输入小于64个字母或32个汉字的名称");var r=t.eq(n).index()+1;if(i=""!==t.eq(n).data("type")?t.eq(n).data("type"):3,""==l&&"none"!==t.eq(n).css("display"))return void alert("名称不能为空！");var o='{"key":"'+t.eq(n).data("id")+'","value":"'+l+'","type":"'+i+'","valueI":"'+r+'"},';""==l?o="":e+=o}e=e.substr(0,e.length-1),a='{"keyValueTypes":['+e+"]}",$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/customer/source/edit",dataType:"json",type:"POST",data:{data:a},success:function(t){return t.success?($.Alert("保存成功！"),void s()):void alert(t.message)}})}),$("#status-set .addGoup").bind("click",function(){$("#status-set-save").show()}),$("#blacklist-set .addGoup").bind("click",function(){$("#blacklist-set-save").show()}),$("#blacklist-set").on("click",".group-remove",function(){var t=$(this);$.Confirm("确认删除？","",function(){t.parent().hide(),t.parent("").attr("data-type","2")})}),$("#blacklist-set-save").on("click",function(){for(var t=$("#blacklist-set ul").children("li"),e="",a="",i="",s=0;s<t.length;s++){var l=t.eq(s).find("input[type=text]").val();if(i=""!==t.eq(s).data("type")?t.eq(s).data("type"):3,""==l&&"none"!==t.eq(s).css("display"))return void alert("名称不能为空！");var r='{"key":"'+t.eq(s).data("id")+'","value":"'+l+'","type":"'+i+'"},';""==l?r="":e+=r}e=e.substr(0,e.length-1),a='{"keyValueTypes":['+e+"]}",$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/customer/blacklist/edit",dataType:"json",type:"POST",data:{data:a},success:function(t){return t.success?($.Alert("保存成功！"),void n()):void alert(t.message)}})}),$("#status-set").on("click",".group-remove",function(){var t=$(this),e=parseInt($(this).parents("li").attr("data-totalCount"));e>0?$.Alert("此状态中有关联信息,请取消后删除"):$.Confirm("确认删除？","",function(){t.parent().hide(),t.parent("").attr("data-type","2")})}),$("#status-set-save").on("click",function(){for(var t=$("#status-set ul").children("li"),e="",a="",i="",s=0;s<t.length;s++){var n=t.eq(s).find("input[type=text]").val();if($.GetLength(n)>64)return void $.Alert("请输入小于64个字母或32个汉字的名称");var r=t.eq(s).index()+1,o=t.eq(s).find(".status-label").css("background-color").colorHex();if(i=""!==t.eq(s).data("type")?t.eq(s).data("type"):3,""==n&&"none"!==t.eq(s).css("display"))return void alert("名称不能为空！");var c='{"key":"'+t.eq(s).data("id")+'","value":"'+n+'","valueI":"'+o+'","type":"'+i+'","valueII":"'+r+'"},';""==n?c="":e+=c}e=e.substr(0,e.length-1),a='{"keyValueTypes":['+e+"]}",$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/customer/status/edit",dataType:"json",type:"POST",data:{data:a},success:function(t){return t.success?($.Alert("保存成功！"),void l()):void alert(t.message)}})}),$("#status-button").on("click",function(){$(".status-ul .status-label:last").css("background-color",getRandomColor())}),$(".status-ul .status-label").each(function(){var t=$(this).parent().children(".resource-input").val().substring(0,1);$(this).text(t)}),$("#status-set-save").on("click",function(){$(".status-ul .resource-input").each(function(){var t=$(this).val().substring(0,1);""==t?$(this).parent().children(".status-label").text("无"):$(this).parent().children(".status-label").text(t)})}),$("#group-set .addGoup").bind("click",function(){$("#group-set-save").show()}),$("#group-set").on("click",".group-remove",function(){var t=$(this),e=parseInt($(this).parents("li").attr("data-totalCount"));e>0?$.Alert("此分组中有关联信息,请取消后删除"):$.Confirm("确认删除？","",function(){t.parent().hide().attr("data-type","2")})}),$("#group-set-save").on("click",function(){for(var t=$("#group-set ul").children("li"),e="",a="",i="",s=0;s<t.length;s++){var n=t.eq(s).find("input[type=text]").val();if($.GetLength(n)>64)return void $.Alert("请输入小于64个字母或32个汉字的名称");var l=t.eq(s).index()+1;if(i=""!==t.eq(s).data("type")?t.eq(s).data("type"):3,""==n&&"none"!==t.eq(s).css("display"))return void alert("名称不能为空！");var o='{"key":"'+t.eq(s).data("id")+'","value":"'+n+'","type":"'+i+'","valueI":"'+l+'"},';""==n?o="":e+=o}e=e.substr(0,e.length-1),a='{"keyValueTypes":['+e+"]}",$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/customer/group/edit",dataType:"json",type:"POST",data:{data:a},success:function(t){return t.success?($.Alert("保存成功！"),void r()):void alert(t.message)}})}),$(".resource-ul").sortable();var k={conditions:[]},x=[];$("#check-sea").change(function(){1==$(this).val()?($("#follower").attr("disabled","disabled"),k.highSeas=1,delete k.followUpUser):($("#follower").removeAttr("disabled"),k.highSeas=0)}),$("#follower").change(function(){k.followUpUser=$(this).val()}),$("#inlineCheckbox").change(function(){$(this).is(":checked")?($("input[name=checkstar]").prop("checked",!0).parent().addClass("checked"),k.starLevels=[1,2,3,4,5]):($("input[name=checkstar]").prop("checked",!1).parent().removeClass("checked"),delete k.starLevels)}),$("input[name=checkstar]").change(function(){$(this).is(":checked")?"starLevels"in k?k.starLevels.push($(this).val()):k.starLevels=[$(this).val()]:(k.starLevels.remove($(this).val()),k.starLevels<=0&&delete k.starLevels)}),$("#group-list").change(function(){0==$(this).val()?delete k.customerGroupId:k.customerGroupId=$(this).val()}),$("#lastest").change(function(){0==$(this).val()?delete k.latestContactDays:k.latestContactDays=$(this).val()}),$("#source-list").change(function(){for(var t,e=$(this),a=k.conditions,i=!1,s=0;s<a.length;s++)if("customerSource"==a[s].filedName){t=s,i=!0;break}if(i)0==e.val()?a.splice(t,1):a[t].filedValue=e.val();else if(0!=e.val()){var n={filedName:"customerSource",operateType:"=",filedValue:e.val()};a.push(n)}}),$("#status-list").change(function(){for(var t,e=$(this),a=k.conditions,i=!1,s=0;s<a.length;s++)if("status"==a[s].filedName){t=s,i=!0;break}if(i)0==e.val()?a.splice(t,1):a[t].filedValue=e.val();else if(0!=e.val()){var n={filedName:"status",operateType:"=",filedValue:e.val()};a.push(n)}}),$("#countries").change(function(){for(var t,e=$(this),a=k.conditions,i=!1,s=0;s<a.length;s++)if("countries"==a[s].filedName){t=s,i=!0;break}if(i)0==e.val()?a.splice(t,1):a[t].filedValue=e.val();else if(0!=e.val()){var n={filedName:"countries",operateType:"=",filedValue:e.val()};a.push(n)}}),$("#createTime").change(function(){k.createTime=$(this).val()}),$("#type-list").change(function(){0==$(this).val()?delete k.customerType:k.customerType=$(this).val()}),$("#btn-screen").click(function(t){$.EventFn(t),$.ajax({url:Base.sitUrl+"/api/customer/v1/customer/backstage/list/query",data:{data:JSON.stringify(k)},type:"POST",dataType:"json",beforeSend:function(t){$.BlockUI()},complete:function(t,e){$.UnblockUI()},success:function(t){if(!t.success)return void $.unLogin(t);var e=t.data,a=e.length;if(e.length>0){$(".result-amount span").text(a);for(var i="",s=0;s<e.length;s++)i+="<li>"+e[s].name+"</li>",x.push(e[s].id);$("#customerModal .customer-list").empty().append(i)}else $(".result-amount span").text(a),x=[],$("#customerModal .customer-list").empty().append("<li>没有客户列表</li>")}})}),$(".btn-onekey-output").click(function(){x<=0?$.Alert("请先筛选客户！"):($.ajax({url:Base.sitUrl+"/api/customer/v1/export/backstage",data:{data:JSON.stringify({ids:x.join(",")})},type:"POST",dataType:"json",success:function(t){if(!t.success)return void $.unLogin(t)}}),setTimeout(function(){$.ajax({url:Base.sitUrl+"/api/customer/v1/export/list",dataType:"json",success:function(t){if(!t.success)return void $.unLogin(t);for(var e=t.data.results,a="",i=0;i<e.length;i++){e[i].statusText=1==e[i].status?"导出中":"完成";var s=1==e[i].status?"":'<a class="btn-output" href="http://'+e[i].url+'">导出</a>';a+="<tr><td>"+e[i].name+"</td>                                            <td>"+e[i].exportNum+"</td>                                            <td>"+e[i].createTime+"</td>                                            <td>"+e[i].statusText+"</td>                                            <td>"+s+"</td></tr>"}$(".cust-list").show(),$("#output-list tbody").empty().append(a)}})},1e3))}),u(),d(),p(),f(),v();for(var T=countries,j="",q=0;q<T.length;q++)j+='<option value="'+T[q].id+'">'+T[q].cn+"</option>";$("#countries").append(j);var C=$('<select class="form-control"></select>'),A='<option value="0">请选择</option>';for(var U in category)A+='<option value="'+U+'">'+category[U].cn_name+"</option>";C.on("change",function(){c(C)}),$("#product-type").append(C.append(A)),$("#client-public-save").on("click",function(){for(var t=$("#client-public").find("input[type=text]"),e="",a="",i="",s=$("#daysNoCC").val(),n=$("#daysNoCh").val(),l=$("#clientEachDay").val(),r=0;r<t.length;r++){var c=t.eq(r).val();if(i=""!==t.eq(r).data("type")?t.eq(r).data("type"):3,isNaN(c))return $.Alert("请填写数字！"),void t.eq(r).css("border","1px solid red")}e+='","valueI":"'+s+'","valueII":"'+n+'","valueVI":"'+l+'","type":"'+i+'"},',e=e.substr(0,e.length-1),a='{"keyValueType":{"key":"'+$("#client-public").data("id")+'","value":"1'+e+"}",$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/settinghighseas/edit",dataType:"json",type:"POST",data:{data:a},success:function(t){return t.success?($.Alert("保存成功！"),void o()):void alert(t.message)}})}),r(),$.ajax({url:Base.sitUrl+"/api/customer/v1/export/list",dataType:"json",success:function(t){if(!t.success)return void $.unLogin(t);for(var e=t.data.results,a="",i=0;i<e.length;i++){e[i].statusText=1==e[i].status?"导出中":"完成";var s=1==e[i].status?"":'<a class="btn-output" href="http://'+e[i].url+'">导出</a>';a+="<tr><td>"+e[i].name+"</td>                                            <td>"+e[i].exportNum+"</td>                                            <td>"+e[i].createTime+"</td>                                            <td>"+e[i].statusText+"</td>                                            <td>"+s+"</td></tr>"}$(".cust-list").show(),$("#output-list tbody").empty().append(a)}})})});