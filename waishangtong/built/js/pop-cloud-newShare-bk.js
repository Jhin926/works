require(["common"],function(){require(["maintab","blockUI"],function(maintab){function follower(){$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/list",type:"POST",dataType:"json",async:!1,success:function(e){var a=e.data;if(a.length>0){for(var i="",t=0;t<a.length;t++){a[t].name;i+='<li data-id="'+a[t].id+'"><input type="checkbox" id="checkbox'+t+'" name="model-checkbox">&nbsp;<label for="checkbox'+t+'" style="display: inline-block;margin-left: 5px;position: absolute;margin-top: 5px;">'+a[t].name+"</label></li>"}$(".modelDwon").empty(),$(".modelDwon").append(i);for(var t=0;t<$(".emailAccount").length;t++)for(var n=0;n<$(".modelDwon").find("li").length;n++)$(".emailAccount").eq(t).attr("data-id")==$(".modelDwon").find("li").eq(n).attr("data-id")&&$(".modelDwon").find("li").eq(n).find("input[type=checkbox]").prop("checked",!0)}else $(".modelDwon").empty()}})}var editData=$.GetQueryString("data");if(""!==editData&&null!==editData&&void 0!==editData){var data=eval("("+editData+")");$("#Newfilename").val(data.name),1==data.operatetype?($("#NewfilePower").prop("checked",!0),$("#NewfilePower").parent("span").addClass("checked")):($("#NewfilePower").prop("checked",!1),$("#NewfilePower").parent("span").removeClass("checked")),0==data.usertype?($("#Newfilepeople1").prop("checked",!0),$("#Newfilepeople1").parent("span").addClass("checked"),$("#Newfilepeople2").prop("checked",!1),$("#Newfilepeople2").parent("span").removeClass("checked")):($("#Newfilepeople1").prop("checked",!1),$("#Newfilepeople1").parent("span").removeClass("checked"),$("#Newfilepeople2").prop("checked",!0),$("#Newfilepeople2").parent("span").addClass("checked"));var user=new Array;user=data.userid.split(","),""!==data.userid&&$.ajax({url:Base.sitUrl+"/api/org/v1/org/staff/list",type:"POST",dataType:"json",async:!1,success:function(e){var a=e.data;if(a.length>0){for(var i="",t=0;t<a.length;t++)for(var n=0;n<user.length;n++)a[t].id==user[n]&&(console.log(123),i+='<span class="emailAccount left successSpan" data-id="'+a[t].id+'"><span class="emailLabel">'+a[t].name+'</span><i class="i-emailClose"></i></span>');$(".stepCont2 span.emailAccount").remove(),$(".stepCont2").prepend(i),$("#addPop").css("display","inline-block")}else $(".modelDwon").empty()}})}var userId=$.GetQueryString("userId");$("#savenewFile").bind("click",function(){var pid=$("#navInput",parent.document).attr("data-pid");pid=0==pid?1:pid;var name=$("#Newfilename").val();if($("#NewfilePower").parent("span").hasClass("checked"))var operateType=1;else var operateType=0;if($("#Newfilepeople1").parent("span").hasClass("checked"))var userType=0;else if($("#Newfilepeople2").parent("span").hasClass("checked"))var userType=1;for(var userIds="",i=0;i<$(".emailAccount").length;i++)userIds+=$(".emailAccount").eq(i).attr("data-id")+",";if(userIds=userIds.substring(0,userIds.length-1),""!==editData&&null!==editData&&void 0!==editData)var url="/api/disk/v1/file/edit",data={view:"1",id:eval("("+editData+")").id,pid:pid,name:name,shareType:"2",operateType:operateType,userType:userType,userIds:userIds};else var url="/api/disk/v1/file/save",data={pid:pid,name:name,file:"",size:"0",type:"0",shareType:"2",operateType:operateType,userType:userType,userIds:userIds};$.ajax({url:Base.sitUrl+url,type:"POST",dataType:"json",data:{data:JSON.stringify(data)},success:function(e){return e.success?($.DestroyPopInPop(),void parent.location.reload()):void $.unLogin(e)}})}),$("#addPop").bind("click",function(){follower()}),$(".stepCont2").on("click",".i-emailClose",function(){$(this).parents("span.emailAccount").remove()}),$("#sure").on("click",function(){for(var e=$(".modelDwon").find("li input[type=checkbox]:checked").length,a="",i=0;i<e;i++){var t=$(".modelDwon").find("li input[type=checkbox]:checked").eq(i).parents("li").find("label").text(),n=$(".modelDwon").find("li input[type=checkbox]:checked").eq(i).parents("li").attr("data-id");a+='<span class="emailAccount left successSpan" data-id="'+n+'"><span class="emailLabel">'+t+'</span><i class="i-emailClose"></i></span>'}$(".stepCont2 span.emailAccount").remove(),$(".stepCont2").prepend(a),$("#myModal .close").click()}),$("input[name=f-people]").bind("click",function(){$("#Newfilepeople2").prop("checked")?$("#addPop").show():$("#addPop").hide()})})});