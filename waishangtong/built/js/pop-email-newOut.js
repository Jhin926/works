require(["common"],function(){require(["maintab","ZeroClipboard","ueditorLang","blockUI","jqform","ztree"],function(e,t){function a(){for(var e=0;e<$(".add-files").find("span.data-code").length;e++){var t=$(".add-files").find("span.data-code").eq(e).attr("data-code"),a=parent.parent.$.menuPower(t);1!==a&&$(".add-files").find("span.data-code").eq(e).addClass("btnRemove")}$(".btnRemove").remove()}function n(){var e;return $.ajax({type:"POST",url:Base.sitUrl+"/api/disk/v1/all/visible/file/list",dataType:"json",async:!1,success:function(t){return t.success?void(e=t.data):void $.Alert(t.message)}}),e}function i(e,t){return!1}function s(){for(var e=new Array,t=n(),a=0;a<t.length;a++){if(1==t[a].type)var i="pIcon",s=!1;else var i="",s=!0;e[a]={id:t[a].id,pId:t[a].pid,name:t[a].name,type:t[a].type,url:t[a].file,open:!1,nocheck:s,iconSkin:i}}$.fn.zTree.init($("#treeDemoAdd"),h,e),$("#selectAll").bind("click",d)}function d(){var e=$.fn.zTree.getZTreeObj("treeDemo");e.setting.edit.editNameSelectAll=$("#selectAll").attr("checked")}function l(e,t){for(var a=$("#"+e).find(".one"),n=0;n<a.length;n++){var i=0,s=a.eq(n).attr("data-id");"undefined"!=s&&null!=s&&""!=s&&(i=parseInt(s));var d=a.eq(n).find("b").html(),l=a.eq(n).find("span").text(),r=l.substr(1,l.length-2);t.push({name:d,email:r,id:i})}}function r(e){y.arr=[],y.ccarr=[],y.bccarr=[],l("divtxt",y.arr),l("carbonCopy",y.ccarr),l("blindCarbonCopy",y.bccarr);var t=$("#sendTheme").val(),a=$("#added-files>li"),n=[],i=!0,s={content:UE.getEditor("sendEditor").getContent(),subject:t};if($("#priority").prop("checked")&&(s.priority=1),""!==$("#sendTheme").attr("data-id")&&(s.draftId=$("#sendTheme").attr("data-id")),$("#readReturn").prop("checked")&&(s.readReturn=!0),$("#tracking").prop("checked")&&(s.tracking=!0),y.arr.length>0?s.tos=y.arr:e||(alert("请输入收件人！"),i=!1),y.ccarr.length>0&&(s.ccs=y.ccarr),y.bccarr.length>0&&(s.bccs=y.bccarr),a.length>0){for(var d=0;d<a.length;d++)n.push({fileUrl:a.eq(d).attr("data-url"),filename:a.eq(d).children("span").eq(0).text()});s.attachments=n}return{flag:i,obj:s}}function o(e){$.ajax({url:Base.sitUrl+"/api/email/v1/to/attachment",type:"POST",dataType:"json",data:{data:e},beforeSend:function(e){$.BlockUI()},complete:function(e,t){$.UnblockUI()},success:function(e){if(!e.success)return void $.unLogin(e);var t=e.data,a=t.name,n=t.url,i="http://"+n,s='<li data-url="'+i+'"><i class="pub-icon fujian-excl-iocn"></i><span>'+a+'</span><span class="removeLi">删除</span><span class="previewEml">预览</span></li>';$("#added-files").show().prepend(s)}})}function c(){$.ajax({url:Base.sitUrl+"/api/email/setting/v1/signature/get",dataType:"json",type:"POST",success:function(e){if(!e.success)return void $.Alert(e.message);var t=e.data;if(null!==t&&1==t.isUsing){var a='<hr style="width:210px;margin-top:12px;background-color:#b5c4df;float:left;height:1px;border:none;"></br><p></p>',n=t.signature.replace(/&#39;/g,'"');'"'+t.fontColour+'"','"'+t.fontSize+'"';UE.getEditor("sendEditor").ready(function(){UE.getEditor("sendEditor").setContent(a,!0),UE.getEditor("sendEditor").setContent(n,!0)})}}})}function p(){$.ajax({url:Base.sitUrl+"/api/email/setting/v1/config/get",dataType:"json",type:"POST",success:function(e){if(!e.success)return void $.Alert(e.message);var t=e.data;if(t){var a=t.defaultTemplate;0==t.defaultCcOpend&&""!=t.defaultCc&&$("#carbonCopy").prepend('<div class="addr-outer"><div class="one" contenteditable="false" data-type="0"><b></b><span>&lt;'+t.defaultCc+"&gt;</span><span class=fh>;<span><div></div>"),0==t.defaultBccOpend&&""!=t.defaultBcc&&$("#blindCarbonCopy").prepend('<div class="addr-outer"><div class="one" contenteditable="false" data-type="0"><b></b><span>&lt;'+t.defaultBcc+"&gt;</span><span class=fh>;<span><div></div>"),$.ajax({url:Base.sitUrl+"/api/org/v1/org/template/list",dataType:"json",type:"POST",async:!1,success:function(e){if(!e.success)return void $.Alert(e.message);for(var t=e.data,n=0;n<t.length;n++)if(a==t[n].id){var i=t[n].template.replace(/&#39;/g,'"');UE.getEditor("sendEditor").ready(function(){UE.getEditor("sendEditor").setContent(i,!0)})}c()}}),""!==t?UE.getEditor("sendEditor").ready(function(){UE.getEditor("sendEditor").execCommand("forecolor",t.fontColour),UE.getEditor("sendEditor").execCommand("fontsize",t.fontSize),UE.getEditor("sendEditor").execCommand("fontfamily",t.fontStyle)}):UE.getEditor("sendEditor").ready(function(){UE.getEditor("sendEditor").execCommand("forecolor","#000"),UE.getEditor("sendEditor").execCommand("fontsize","14px"),UE.getEditor("sendEditor").execCommand("fontfamily","宋体")})}}})}function u(){$.ajax({url:Base.sitUrl+"/api/product/v1/product/type/sublist?pid=0",type:"GET",dataType:"json",success:function(e){if(!e.success)return void $.unLogin(e);for(var t=e.data,a="",n=0;n<t.length;n++)a+='<option value="'+t[n].id+'">'+t[n].name+"</option>";$("#pdtSelect1").empty().append('<option value="">全部</option>').append(a)}})}function v(){$.ajax({url:Base.sitUrl+"/api/product/v1/product/catelog/list",type:"GET",dataType:"json",success:function(e){if(!e.success)return void $.unLogin(e);for(var t=e.data,a="",n=0;n<t.length;n++)a+='<option value="'+t[n].id+'">'+t[n].name+"</option>";$("#pdtGroup").empty().append('<option value="">全部</option>').append(a)}})}a(),window.ZeroClipboard=t;var f=$.GetQueryString("id"),m=$.GetQueryString("type"),h=($.GetQueryString("modelType"),$.GetQueryString("name"),$.GetQueryString("ids"),{view:{selectedMulti:!1},check:{enable:!0},data:{simpleData:{enable:!0}},callback:{beforeDrag:i}});$(".divtxt").on("click",function(e){$.EventFn(e);var t=$(this).attr("id");"carbonCopy"==t?y.clickRecord=1:"blindCarbonCopy"==t?y.clickRecord=2:y.clickRecord=0}),$(".input-group").on("mouseenter",".one",function(e){$(this).addClass("ones")}),$(".input-group").on("mouseleave",".one",function(e){$(this).removeClass("ones")}),$(".divtxt").click(function(){return $("input[name=text]").click()}),$(".input-group").on("dblclick",".one",function(e){var t=$(this).closest(".one"),a=t.attr("data-type"),n=t.attr("data-id"),i=y.arr,s=[];1==a?t.attr("contentEditable","true"):2==a?t.attr("contentEditable","true"):t.attr("contentEditable","true");for(var d=0;d<i.length;d++)i[d].id!=n&&s.push(i[d]);1==a?(y.bccarr=s,$("#carbonCopy").val("")):2==a?(y.ccarr=s,$("#blindCarbonCopy").val("")):($("#divtxt").val(""),y.arr=s)}),$("#added-files").on("click",">li>.dels-file",function(e){$.EventFn(e),$(this).parent().remove()}),$(".sentbox-right").on("click",">.ess>.essy>ul>li",function(e){$.EventFn(e);var t=$(this).children("span"),a=t.eq(1).attr("data-email");if(1==y.clickRecord){var n=$("#carbonCopy").val(),i="";null==n||""==n?(n=$("#carbonCopy").val(a+";"),i='<div class="addr-outer"><div class="one" contenteditable="false" data-type="1" data-id="'+$(this).attr("data-id")+'"><b>'+t.eq(0).text()+"</b><span>&lt;"+t.eq(1).attr("data-email")+"&gt;</span><span class=fh>;<span><div></div>"):n.indexOf(a)==-1&&(n=$("#carbonCopy").val(n+a+";"),i='<div class="addr-outer"><div class="one" contenteditable="false" data-type="1" data-id="'+$(this).attr("data-id")+'"><b>'+t.eq(0).text()+"</b><span>&lt;"+t.eq(1).attr("data-email")+"&gt;</span><span class=fh>;<span><div></div>"),$("#carbonCopy").prepend(i)}else if(2==y.clickRecord){var n=$("#blindCarbonCopy").val(),i="";null==n||""==n?(n=$("#blindCarbonCopy").val(a+";"),i='<div class="addr-outer"><div class="one" contenteditable="false" data-type="2" data-id="'+$(this).attr("data-id")+'"><b>'+t.eq(0).text()+"</b><span>&lt;"+t.eq(1).attr("data-email")+"&gt;</span><span class=fh>;<span><div></div>"):n.indexOf(a)==-1&&(i='<div class="addr-outer"><div class="one" contenteditable="false" data-type="2" data-id="'+$(this).attr("data-id")+'"><b>'+t.eq(0).text()+"</b><span>&lt;"+t.eq(1).attr("data-email")+"&gt;</span><span class=fh>;<span><div></div>"),$("#blindCarbonCopy").prepend(i)}else{var n=$("#divtxt").val(),i="";null==n||""==n?i='<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+$(this).attr("data-id")+'"><b>'+t.eq(0).text()+"</b><span>&lt;"+t.eq(1).attr("data-email")+"&gt;</span><span class=fh>;<span><div></div>":n.indexOf(a)==-1&&(i='<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+$(this).attr("data-id")+'"><b>'+t.eq(0).text()+"</b><span>&lt;"+t.eq(1).attr("data-email")+"&gt;</span><span class=fh>;<span><div></div>"),$("#divtxt").prepend(i)}}),$("#carbonCopy").on("click",function(e){$.EventFn(e),$("#clickRecord").val(1)}),$("#blindCarbonCopy").on("click",function(e){$.EventFn(e),$("#clickRecord").val(2)}),$(".input-group").on("click",".receptetips>li",function(e){$.EventFn(e);var t=$(this).closest("td").find(".receptetips"),a=$(this).closest("td").find(".inputaddress"),n=$(this).children("span"),i=n.eq(1).attr("data-email");if(1==y.clickRecord){var s=$("#carbonCopy").val(),d="";null==s||""==s?d='<div class="addr-outer"><div class="one" contenteditable="false" data-type="1" data-id="'+$(this).attr("data-id")+'"><b>'+n.eq(0).text()+"</b><span>&lt;"+n.eq(1).attr("data-email")+"&gt;</span><span class=fh>;<span><div></div>":s.indexOf(i)==-1&&(d='<div class="addr-outer"><div class="one" contenteditable="false" data-type="1" data-id="'+$(this).attr("data-id")+'"><b>'+n.eq(0).text()+"</b><span>&lt;"+n.eq(1).attr("data-email")+"&gt;</span><span class=fh>;<span><div></div>"),a.val(""),$("#carbonCopy").prepend(d),t.hide()}else if(2==y.clickRecord){var s=$("#blindCarbonCopy").val(),d="";null==s||""==s?d='<div class="addr-outer"><div class="one" contenteditable="false" data-type="2" data-id="'+$(this).attr("data-id")+'"><b>'+n.eq(0).text()+"</b><span>&lt;"+n.eq(1).attr("data-email")+"&gt;</span><span class=fh>;<span><div></div>":s.indexOf(i)==-1&&(d='<div class="addr-outer"><div class="one" contenteditable="false" data-type="2" data-id="'+$(this).attr("data-id")+'"><b>'+n.eq(0).text()+"</b><span>&lt;"+n.eq(1).attr("data-email")+"&gt;</span><span class=fh>;<span><div></div>"),a.val(""),$("#blindCarbonCopy").prepend(d),t.hide()}else{var s=$("#divtxt").val(),d="";null==s||""==s?d='<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+$(this).attr("data-id")+'"><b>'+n.eq(0).text()+"</b><span>&lt;"+n.eq(1).attr("data-email")+"&gt;</span><span class=fh>;<span><div></div>":s.indexOf(i)==-1&&(d='<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+$(this).attr("data-id")+'"><b>'+n.eq(0).text()+"</b><span>&lt;"+n.eq(1).attr("data-email")+"&gt;</span><span class=fh>;<span><div></div>"),a.val(""),$("#divtxt").prepend(d),t.hide()}});var g=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/;$(".input-group").on("blur",".inputaddress",function(e){var t=$(this).val(),a="";if(null!=t&&""!=t){if(!g.test(t))return void(null!=t&&""!=t&&(a='<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+$(this).attr("data-id")+'"><b></b><span class="emailError">&lt;'+t+"&gt;</span><span class=fh>;<span><div></div>",$(this).parent(".addressinput").parent(".divtxt").find(".addrcontainer").append(a),$(this).val(""),$tips.hide()));a='<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+$(this).attr("data-id")+'"><b></b><span>&lt;'+t+"&gt;</span><span class=fh>;<span><div></div>",$(this).val("").parent(".addressinput").parent(".divtxt").find(".addrcontainer").append(a)}}),$(".input-group").on("keyup",".inputaddress",function(e){var t=$(this).closest(".divtxt").parent("td").find(".receptetips");if("186"==e.keyCode||"9"==e.keyCode){var a=$(this).val();if(!g.test(a))return void(null!=a&&""!=a&&(n='<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+$(this).attr("data-id")+'"><b></b><span class="emailError">&lt;'+a+"&gt;</span><span class=fh>;<span><div></div>",$(this).parent(".addressinput").parent(".divtxt").find(".addrcontainer").append(n),$(this).val(""),t.hide()));var n="";a=a.substring(0,a.length-1),null!=a&&""!=a&&(n='<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+$(this).attr("data-id")+'"><b></b><span>&lt;'+a+"&gt;span><span class=fh>;<span><div></div>",$(this).val("").parent(".addressinput").parent(".divtxt").find(".addrcontainer").append(n),t.hide())}else if("40"==e.keyCode&&"block"==$(".receptetips").css("display")){if($(".receptetips li.active").index()==$(".receptetips li").length-1)return;$(".receptetips li.active").next("li").addClass("active"),$(".receptetips li.active").eq(0).removeClass("active")}else if("38"==e.keyCode&&"block"==$(".receptetips").css("display")){if(0==$(".receptetips li.active").index())return;$(".receptetips li.active").prev("li").addClass("active"),$(".receptetips li.active").eq(1).removeClass("active")}else if("13"==e.keyCode&&"block"==$(".receptetips").css("display")){var t=$(".receptetips li.active").closest("td").find(".receptetips"),i=$(".receptetips li.active").closest("td").find(".inputaddress"),s=$(".receptetips li.active").children("span"),d=s.eq(1).attr("data-email");i.val("");var l=$("#divtxt").val(),n="";null==l||""==l?n='<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+$(this).attr("data-id")+'"><b>'+s.eq(0).text()+"</b><span>&lt;"+s.eq(1).attr("data-email")+"&gt;</span><span class=fh>;<span><div></div>":l.indexOf(d)==-1&&(n='<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+$(this).attr("data-id")+'"><b>'+s.eq(0).text()+"</b><span>&lt;"+s.eq(1).attr("data-email")+"&gt;</span><span class=fh>;<span><div></div>"),$("#divtxt").find(".addrcontainer").append(n),t.hide()}else if("13"==e.keyCode){var a=$(this).val();if(!g.test(a))return void(null!=a&&""!=a&&(n='<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+$(this).attr("data-id")+'"><b></b><span class="emailError">&lt;'+a+"&gt;</span><span class=fh>;<span><div></div>",$(this).parent(".addressinput").parent(".divtxt").find(".addrcontainer").append(n),$(this).val(""),t.hide()));var n="";null!==a&&(n+='<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+$(this).attr("data-id")+'"><b></b><span>&lt;'+a+"&gt;</span><span class=fh>;<span><div></div>",$(this).parents("#divtxt").find(".addrcontainer").append(n),$(this).val(""),t.hide())}}),$(".input-group").on("keydown",".addr-edit input",function(e){$.EventFn(e),"8"==event.keyCode&&$(this).closest(".addr-outer").remove()}),$(".input-group").on("keydown",".inputaddress",function(e){if("8"==e.keyCode){var t=$(this).parent(".addressinput").prev(".addrcontainer").find(".one:last"),a=t.attr("data-id"),n=t.attr("data-type"),i=y.arr,s=[];1==n?(null!=$(this).val()&&""!=$(this).val()||t.remove(),i=y.bccarr):2==n?(null!=$(this).val()&&""!=$(this).val()||t.remove(),i=y.ccarr):null!=$(this).val()&&""!=$(this).val()||t.remove();for(var d=0;d<i.length;d++)i[d].id!=a&&s.push(i[d]);1==n?(y.bccarr=s,$("#carbonCopy").val("")):2==n?(y.ccarr=s,$("#blindCarbonCopy").val("")):($("#divtxt").val(""),y.arr=s)}}),$(".input-group").on("blur",".inputaddress",function(){var e=$(this).val(),t="";null!=e&&""!=e&&(t='<div class="addr-outer"><div class="one" data-type="0" data-id="'+$(this).attr("data-id")+'"><b></b><span>&lt;'+e+"&gt;</span><span class=fh>;<span><div></div>",$(this).val("").parent(".addressinput").parent(".divtxt").prepend(t))}),$(".input-group").on("focus",".inputaddress",function(e){$.EventFn(e);var t=$(this).closest("td").find(".receptetips"),a=y.tipslist.unique();if(0==t.children("li").length){for(var n="",i=0;i<a.length;i++)n+='<li data-id="'+a[i].value+'">                                <span>'+a[i].name+'</span>                                <span data-email="'+a[i].value+'">('+a[i].value+")</span>                            </li>";t.append(n)}}),$(".input-group").on("input",".inputaddress",function(){for(var e=y.tipslist,t=[],a=$(this).closest(".divtxt").parent("td").find(".receptetips"),n=0;n<e.length;n++)e[n].name.indexOf($(this).val())!=-1&&t.push(e[n]);if(t.length>0){a.show();for(var i="",s=0;s<t.length;s++)i+="<li>                                <span>"+t[s].name+'</span>                                <span data-email="'+t[s].value+'">('+t[s].value+")</span>                            </li>";a.empty().append(i)}else a.hide()}),$(".sentbox-left").on("click","#shoujianren-title",function(e){$.EventFn(e),$(".sentbox-left").children(".csAndMs").slideToggle("slow"),$(this).children(".down-zk-icon").toggleClass("up-zk-icon")}),$(".emailcondition").bind("change","label",function(e){$.EventFn(e),$(this).find("input").prop("checked",$(this).prop("checked"))}),$("#sendEmail").on("click",function(e){if($.EventFn(e),$("#divtxt").find(".emailError").length>0)return void $.Alert("邮箱格式有误");var t=r();t.flag&&y.sendEmail(t.obj)}),$("#saveDrafts").on("click",function(e){$.EventFn(e);var t=r(12);y.saveDrafts(t.obj),parent.location.reload()}),$(".add-attachment").on("click",function(){$("input[name=upFiles]").click()}),$("input[name=upFiles]").on("change",function(e){$.EventFn(e);var t=y.fileLimit($(this));t.flag&&y.uploadFujian(t.name)}),$(".add-images").click(function(){$("input[name=upImgs]").click()}),$("input[name=upImgs]").on("change",function(e){$.EventFn(e);var t=y.fileLimit($(this));t.flag&&y.uploadImg(t.name)}),$("#emailContacts>li").on("click",function(e){if($.EventFn(e),!$(this).hasClass("current")){$(this).addClass("current").siblings().removeClass("current");var t=$(this).index();$(".rightShowList").eq(t).addClass("activities").siblings().removeClass("activities")}}),$(".sentbox-right").on("input","#search-input",function(e){$.EventFn(e);var t=$("#search-input").val(),a=$(this).closest(".sentbox-right").find(".search-list"),n=a.children(".essy").children("#search-list"),i=y.tipslist.unique(),s=[];if(t.length>0){$("#c-search-btn").addClass("clear-icon-email").removeClass("search-icon-email"),$("#emailContacts").hide(),$("#content").hide(),a.show();for(var d=0;d<i.length;d++)i[d].name.indexOf(t)==-1&&i[d].value.indexOf(t)==-1||s.push(i[d]);if(s.length>0){for(var l="",r=0;r<s.length;r++)l+="<li>                                    <span>"+s[r].name+'</span>                                    <span data-email="'+s[r].value+'">('+s[r].value+"&gt;</span>                                </li>";n.empty().append(l)}else l="<li>没有找到该联系人！</li>",n.empty().append(l)}else $("#emailContacts,#content").show(),$("#c-search-btn").addClass("search-icon-email").removeClass("clear-icon-email"),a.hide()}),$(".sentbox-right").on("click",".clear-icon-email",function(e){$.EventFn(e),$("#search-input").val("");var t=$("#search-input").val(),a=$(this).closest(".sentbox-right").find(".search-list");t.length<1&&($("#emailContacts,#content").show(),a.hide())}),$(".sentbox-right").on("input","#search-input",function(e){$.EventFn(e);var t=$("#search-input").val(),a=$(this).closest(".sentbox-right").find(".search-list");t.length<1&&($("#emailContacts,#content").show(),a.hide())}),$(".add-files").on("click",".add-text",function(e){b.currentPage=1,y.fastText(),$("#myModalLabel").empty().text("选择快速文本"),$(".modal-footer .btn:last-child").attr("id","textBtn"),$("#myModal").find(".form-group").hide(),$("#treeDemoAdd").hide(),$("#myModal .modelDwon").show(),$("#myModal .page").hide()}),$(".add-files").on("click",".add-cloud",function(e){b.currentPage=1,s(),$("#myModalLabel").empty().text("选择云文件"),$(".modal-footer .btn:last-child").attr("id","cloudBtn"),$("#myModal").find(".form-group").hide(),$("#treeDemoAdd").show(),$("#myModal .modelDwon").hide(),$("#myModal .page").hide()}),$(".add-files").on("click",".add-model",function(e){b.currentPage=1,y.insertModel(),$("#myModalLabel").empty().text("选择模板"),$(".modal-footer .btn:last-child").attr("id","modelBtn"),$("#modelInput").show().siblings(".form-group").hide(),$("#treeDemoAdd").hide(),$("#myModal .modelDwon").show(),$("#myModal .page").hide()}),$(".add-files").on("click",".add-PI",function(e){b.currentPage=1,y.insertModelPi(),$("#myModalLabel").empty().text("选择PI模板"),$(".modal-footer .btn:last-child").attr("id","piBtn"),$("#piInput").show().siblings(".form-group").hide(),$("#treeDemoAdd").hide(),$("#myModal .modelDwon").show(),$("#myModal .page").hide()}),$(".add-files").on("click",".add-quotation",function(e){b.currentPage=1,y.insertModel3(),$("#myModalLabel").empty().text("选择报价单"),$(".modal-footer .btn:last-child").attr("id","quoteBtn"),$("#quoteInput").show().siblings(".form-group").hide(),$("#treeDemoAdd").hide(),$("#myModal .modelDwon").show(),$("#myModal .page").hide()}),$(".add-files").on("click",".add-product",function(e){b.currentPage=1,y.insertModelPdt(),u(),v(),$("#myModalLabel").empty().text("选择产品"),$(".modal-footer .btn:last-child").attr("id","pdtBtn"),$("#pdtInput1").show().siblings(".form-group").hide(),$("#pdtInput2").css("display","inline-block"),$("#pdtInput3").css("display","inline-block"),$("#treeDemoAdd").hide(),$("#myModal .modelDwon").show(),$("#myModal .page").show()}),$(".modal-footer .btn:last-child").unbind("click").on("click",function(e){$.EventFn(e);var t=$(this).attr("id");if("pdtBtn"==t){for(var a=new Array,n=$("#myModal .modelDwon").find("input[type=checkbox]:checked").length,i=0;i<n;i++){var s=$("#myModal .modelDwon").find("input[type=checkbox]:checked").eq(i).parents("li").attr("data-id");s=parseInt(s),a+=s+","}a=a.substring(0,a.length-1),$.ajax({url:Base.sitUrl+"/api/export/v1/product/picture",type:"POST",data:{ids:a},beforeSend:function(e){$.BlockUI()},complete:function(e,t){$.UnblockUI()},success:function(e){if(!e.success)return void $.unLogin(e);for(var t=e.data,a="",n=0;n<t.length;n++){var i="http://"+t[n].pictureUrl;a+='<img src="'+i+'" style="max-width:800px"><p></p>';var s="http://"+t[n].pdfUrl,d='<li data-url="'+s+'"><i class="pub-icon fujian-excl-iocn"></i><span>'+t[n].pdfName+'</span> <span class="att-size">( '+t[n].pdfSize+' )</span> <span class="removeLi">删除</span><span class="previewEml">预览</span></li>';$("#added-files").show().prepend(d)}UE.getEditor("sendEditor").execCommand("inserthtml",a),$("#myModal .close").click()}})}else if("quoteBtn"==t){for(var a=new Array,n=$("#myModal .modelDwon").find("input[type=checkbox]:checked").length,i=0;i<n;i++){var s=$("#myModal .modelDwon").find("input[type=checkbox]:checked").eq(i).parents("li").attr("data-id");s=parseInt(s),a+=s+","}a=a.substring(0,a.length-1),$.ajax({url:Base.sitUrl+"/api/export/v1/quotation/picture",type:"POST",data:{ids:a},beforeSend:function(e){$.BlockUI()},complete:function(e,t){$.UnblockUI()},success:function(e){if(!e.success)return void $.unLogin(e);for(var t=e.data,a="",n=0;n<t.length;n++){var i="http://"+t[n].pictureUrl;a+='<br /><br /><br /><img src="'+i+'" style="max-width:800px"><br />';var s="http://"+t[n].pdfUrl,d='<li data-url="'+s+'"><i class="pub-icon fujian-excl-iocn"></i><span>'+t[n].pdfName+'</span> <span class="att-size">( '+t[n].pdfSize+' )</span> <span class="removeLi">删除</span><span class="previewEml">预览</span></li>';$("#added-files").show().prepend(d)}UE.getEditor("sendEditor").execCommand("inserthtml",a),$("#myModal .close").click()}})}else if("piBtn"==t){for(var a=new Array,n=$("#myModal .modelDwon").find("input[type=checkbox]:checked").length,i=0;i<n;i++){var s=$("#myModal .modelDwon").find("input[type=checkbox]:checked").eq(i).parents("li").attr("data-id");s=parseInt(s),a+=s+","}a=a.substring(0,a.length-1),$.ajax({url:Base.sitUrl+"/api/export/v1/pi/picture",type:"POST",data:{ids:a},beforeSend:function(e){$.BlockUI()},complete:function(e,t){$.UnblockUI()},success:function(e){if(!e.success)return void $.unLogin(e);for(var t=e.data,a="",n=0;n<t.length;n++){var i="http://"+t[n].pictureUrl;a+='<br /><br /><br /><img src="'+i+'" style="max-width:800px"><br />';var s="http://"+t[n].pdfUrl,d='<li data-url="'+s+'"><i class="pub-icon fujian-excl-iocn"></i><span>'+t[n].pdfName+'</span> <span class="att-size">( '+t[n].pdfSize+' )</span> <span class="removeLi">删除</span><span class="previewEml">预览</span></li>';$("#added-files").show().prepend(d)}UE.getEditor("sendEditor").execCommand("inserthtml",a),$("#myModal .close").click()}})}else if("modelBtn"==t){var s=$("#myModal .modelDwon").find("input[type=checkbox]:checked").parents("li").attr("data-value");UE.getEditor("sendEditor").execCommand("inserthtml",s),$("#myModal .close").click()}else if("textBtn"==t){var s=$("#myModal .modelDwon").find("input[type=checkbox]:checked").parents("li").attr("data-value");UE.getEditor("sendEditor").execCommand("inserthtml",s),$("#myModal .close").click()}else if("cloudBtn"==t){var d=$.fn.zTree.getZTreeObj("treeDemoAdd"),l=d.getCheckedNodes(!0),r="";if($("#added-files").find("li").length>0)for(var i=0;i<l.length;i++){for(var o,c=0;c<$("#added-files").find("li").length;c++){var p=$("#added-files").find("li").eq(c).attr("data-url");p==l[i].url&&(o=1)}1==o?(r+="",o=0):r+='<li data-url="'+l[i].url+'"><i class="pub-icon fujian-excl-iocn"></i><span>'+l[i].name+'</span> <span class="att-size"></span> <span class="removeLi">删除</span><span class="previewEml">预览</span></li>'}else for(var i=0;i<l.length;i++){var p=$(".added-files").find("li").eq(c).attr("data-url");r+=p!==l[i].url?'<li data-url="'+l[i].url+'"><i class="pub-icon fujian-excl-iocn"></i><span>'+l[i].name+'</span> <span class="att-size"></span> <span class="removeLi">删除</span><span class="previewEml">预览</span></li>':""}$("#added-files").show().prepend(r),$("#myModal .close").click()}});var b={homepage:1,lastpage:null,currentPage:1,pageSize:8};$("#pagination").delegate("li","click",function(e){var t=e||window.event;t.preventDefault(),$(this).hasClass("active")||$(this).hasClass("disabled")||(b.currentPage=$(this).children().attr("data-page"),$(this).addClass("active").siblings().removeClass("active"))});var y={searchContacts:[],tipslist:[],arr:[],ccarr:[],bccarr:[],clickRecord:0,addressList:function(){var e=$("#search-input").val()||"",t=Base.sitUrl+"/api/addressList/v1/quickList";e&&(t+="?keyword="+e),$.ajax({url:t,type:"GET",success:function(e){if(!e.success)return void $.unLogin(e);var t=e.data,a="";if(t.length>0){for(var n=0;n<t.length;n++)y.tipslist.push(t[n]),a+='<li data-id="'+t[n].value+'"><span>'+t[n].name+'</span><span data-email="'+t[n].value+'">&lt;'+t[n].value+"&gt;</span></li>";$("#personalMaillist").append(a)}}})},contactsList:function(){var e=$("#search-input").val()||"",t=Base.sitUrl+"/api/customer/contacts/v1/quickList";e&&(t+="?keyword="+e),$.ajax({url:t,type:"GET",success:function(e){if(!e.success)return void $.unLogin(e);var t=e.data,a="";if(t.length>0){for(var n=0;n<t.length;n++)y.tipslist.push(t[n]),a+='<li data-id="'+t[n].value+'"><span>'+t[n].name+'</span><span data-email="'+t[n].value+'">&lt;'+t[n].value+"&gt;</span></li>";$("#companyMaillist").append(a)}}})},sendEmail:function(e){return y.operationEmail(e,"/api/email/v1/send")},saveDrafts:function(e){return y.operationEmail(e,"/api/email/v1/draft/save")},operationEmail:function(e,t){var a={};return $.ajax({url:Base.sitUrl+t,type:"POST",data:{data:JSON.stringify(e)},success:function(e){if(!e.success)return void $.unLogin(e);$.DestroyPopInPop();var a="";if("/api/email/v1/send"==t){for(var n=0;n<$(".addr-outer").length;n++){var i=$(".addr-outer").eq(n).find(".one").find("span").eq(0).text();a+=i.substring(1,i.length-1)+","}a=a.substring(0,a.length-1),$("#mainIframe",top.document).attr("src",Base.sitUrl+"/html/pop-email-success.html?id="+e.data+"&email="+a)}else"/api/email/v1/draft/save"==t&&$.Alert("保存草稿成功！","",function(){var e=$("#mainTab",parent.document).find(".currentClass").index();parent.me.closeOne(e,!0)})}}),a},signature:function(){$.ajax({url:Base.sitUrl+"/api/email/setting/v1/signature/get",type:"GET",success:function(e){if(!e.success)return void $.unLogin(e);var t=e.data,a="";null!=t&&""!=t&&(a='<div class="signature">'+t.signature+"</div>")}})},fastText:function(){$.ajax({url:Base.sitUrl+"/api/email/setting/v1/qtexts/search",type:"GET",success:function(e){if(!e.success)return void $.unLogin(e);var t=e.data,a="";if(null!=t&&""!=t)for(var n=0;n<t.length;n++)a+='<li data-value="'+t[n].value+'"><input type="checkbox" id="checkbox'+n+'" name="model-checkbox">&nbsp;<label for="checkbox'+n+'" style="display: inline-block;margin-left: 5px;margin-top: 5px;">'+t[n].name+"</label></li>";else a+='<div class="text-center">暂无快速文本</div>';$("#myModal .modelDwon").empty().append(a);var i=t.length+1,s=Math.ceil(i/b.pageSize);$.Page({_class:".pageText",nowNum:b.currentPage,allNum:s,callback:function(e,t){b.currentPage=e,y.fastText()}})}})},insertModel:function(){$.ajax({url:Base.sitUrl+"/api/email/setting/v1/templates/search",type:"GET",success:function(e){if(!e.success)return void $.unLogin(e);var t=e.data,a="";if(null!=t&&""!=t)for(var n=0;n<t.length;n++)a+='<li data-value="'+t[n].value+'"><input type="checkbox" id="checkbox'+n+'" name="model-checkbox">&nbsp;<label for="checkbox'+n+'" style="display: inline-block;margin-left: 5px;margin-top: 5px;">'+t[n].name+"</label></li>";else a+='<div class="text-center">暂无模板</div>';$("#myModal .modelDwon").empty().append(a);var i=t.length+1,s=Math.ceil(i/b.pageSize);$.Page({_class:".pageMod",nowNum:b.currentPage,allNum:s,callback:function(e,t){b.currentPage=e,y.insertModel()}})}})},insertModelPi:function(e){$.ajax({url:Base.sitUrl+"/api/export/v1/list",type:"GET",data:{type:2,name:e},beforeSend:function(){$.BlockUI()},complete:function(){$.UnblockUI()},success:function(e){if(!e.success)return void $.unLogin(e);var t=e.data.results,a="";if(null!=t&&""!=t)for(var n=0;n<t.length;n++)a+='<li data-id="'+t[n].id+'"><input type="checkbox" id="checkbox'+n+'" name="model-checkbox">&nbsp;<label for="checkbox'+n+'" style="display: inline-block;margin-left: 5px;margin-top: 5px;">'+t[n].name+"</label></li>";else a+='<div class="text-center">暂无PI模板</div>';$("#myModal .modelDwon").empty().append(a);var i=t.length+1,s=Math.ceil(i/b.pageSize);$.Page({_class:".pagePi",nowNum:b.currentPage,allNum:s,callback:function(e,t){b.currentPage=e,y.insertModelPi()}})}})},insertModelPdt:function(e,t,a){$.ajax({url:Base.sitUrl+"/api/export/v1/list",type:"GET",data:{type:1,name:e,productCatelog:t,productType:a,currentPage:b.currentPage,pageSize:b.pageSize},beforeSend:function(e){$.BlockUI()},complete:function(e,t){$.UnblockUI()},success:function(e){if(!e.success)return void $.unLogin(e);var t=e.data.results,a="";if(null!=t&&""!=t)for(var n=0;n<t.length;n++)a+='<li data-id="'+t[n].id+'"><input type="checkbox" id="checkbox'+n+'" name="model-checkbox">&nbsp;<label for="checkbox'+n+'" style="display: inline-block;margin-left: 5px;margin-top: 5px;">'+t[n].name+"</label></li>";else a+='<div class="text-center">暂无产品模板</div>',$(".page").hide();$("#myModal .modelDwon").empty().append(a)}})},insertModel3:function(e){$.ajax({url:Base.sitUrl+"/api/export/v1/list",type:"GET",data:{type:3,name:e},beforeSend:function(){$.BlockUI()},complete:function(){$.UnblockUI()},success:function(e){if(!e.success)return void $.unLogin(e);var t=e.data.results,a="";if(null!=t&&""!=t)for(var n=0;n<t.length;n++)a+='<li data-id="'+t[n].id+'"><input type="checkbox" id="checkbox'+n+'" name="model-checkbox">&nbsp;<label for="checkbox'+n+'" style="display: inline-block;margin-left: 5px;margin-top: 5px;">'+t[n].name+"</label></li>";else a+='<div class="text-center">暂无报价单</div>';$("#myModal .modelDwon").empty().append(a);var i=t.length+1,s=Math.ceil(i/b.pageSize);$.Page({_class:".pageQuo",nowNum:b.currentPage,allNum:s,callback:function(e,t){b.currentPage=e,y.insertModel3()}})}})},uploadFujian:function(e,t){$("#form_file").ajaxForm({url:Base.sitUrl+"/api/file/upload",beforeSend:function(){$.BlockUI()},complete:function(){$.UnblockUI()},success:function(t){if(!t.success)return void $.unLogin(t);var a="http://"+t.data,n='<li data-url="'+a+'"><i class="pub-icon fujian-excl-iocn"></i><span>'+e+'</span><span class="removeLi">删除</span><span class="previewEml">预览</span></li>';$("#added-files").prepend(n)}}).submit()},uploadImg:function(e,t){$("#form_img").ajaxForm({url:Base.sitUrl+"/api/file/upload",beforeSend:function(){
$.BlockUI()},complete:function(){$.UnblockUI()},success:function(e){if(!e.success)return void $.unLogin(e);var t="http://"+e.data;UE.getEditor("sendEditor").execCommand("insertimage",{src:t,width:"300"})}}).submit()},fileLimit:function(e){var t=!0,a=e.prop("files"),n=Math.round(a[0].size/1024*100)/100/1024;return n>20&&($.Alert("上传附件需小于20MB"),t=!1),{flag:t,name:a[0].name}},huifuEmail:function(e){var t={id:f};if(5==m)var a=Base.sitUrl+"/api/email/draft/v1/detail";else var a=Base.sitUrl+"/api/email/outbox/v1/detail";$.ajax({url:a,type:"GET",data:t,success:function(e){if(!e.success)return void $.unLogin(e);var t=e.data,a=t.ccs,n="RE:"+t.subject,i="Fw:"+t.subject,s="",d="",l="",r="";if(a.length>0)for(var c=0;c<a.length;c++)d+=null!=a[c].name&&""!=a[c].name?'<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+f+'"><b>'+a[c].name+"</b><span>&lt;"+a[c].value+"&gt;</span><span class=fh>;<span><div></div>":'<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+f+'"><b></b><span>&lt;'+a[c].value+"&gt;</span><span class=fh>;<span><div></div>";for(var c=0;c<t.tos.length;c++)l+=t.tos[c].value+";";for(var c=0;c<t.froms.length;c++)r+=t.froms[c].value+";";var p='<div style="margin-top: 0px; margin-bottom: 0px; margin-left: 0.5em;"><div style="border:none;border-top:solid #B5C4DF 1.0pt;padding:3.0pt 0cm 0cm 0cm"><div style="PADDING-RIGHT: 8px; PADDING-LEFT: 8px; FONT-SIZE: 12px;FONT-FAMILY:tahoma;COLOR:#000000; BACKGROUND: #efefef; PADDING-BOTTOM: 8px; PADDING-TOP: 8px"><p></p><p></p><p style="margin:0;padding:2px 5px;background:#eee;font-size:12px"><b>From:</b>'+r+'</p><p style="margin:0;padding:2px 5px;background:#eee;font-size:12px"><b>Date:</b>'+t.sendTime+'</p><p style="margin:0;padding:2px 5px;background:#eee;font-size:12px"><b>To:</b>'+l+'</p><p style="margin:0;padding:2px 5px;background:#eee;font-size:12px"><b>Subject:</b>'+t.subject+"</p><p></p></div></div></div>";if(0==m)s=null!=t.froms[0].name&&""!=t.froms[0].value?'<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+f+'"><b>'+t.froms[0].name+"</b><span>&lt;"+t.froms[0].value+"&gt;</span><span class=fh>;<span><div></div>":'<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+f+'"><b></b><span>&lt;'+t.froms[0].value+"&gt;</span><span class=fh>;<span><div></div>",$("#divtxt").prepend(s);else if(1==m)s=null!=t.tos[0].name&&""!=t.tos[0].value?'<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+f+'"><b>'+t.tos[0].name+"</b><span>&lt;"+t.tos[0].value+"&gt;</span><span class=fh>;<span><div></div>":'<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+f+'"><b></b><span>&lt;'+t.tos[0].value+"&gt;</span><span class=fh>;<span><div></div>",$("#sendTheme").val(n),$("#divtxt").prepend(s),UE.getEditor("sendEditor").ready(function(){UE.getEditor("sendEditor").setContent(p,!0),UE.getEditor("sendEditor").setContent(t.content,!0)});else if(2==m)$("#sendTheme").val(i),UE.getEditor("sendEditor").ready(function(){UE.getEditor("sendEditor").setContent(p,!0),UE.getEditor("sendEditor").setContent(t.content,!0)});else if(3==m)$("#sendTheme").val(n),UE.getEditor("sendEditor").ready(function(){UE.getEditor("sendEditor").setContent(p,!0),UE.getEditor("sendEditor").setContent(t.content,!0)});else if(5==m){for(var u=t.tos,v="",c=0;c<u.length;c++)v+='<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id=""><b>'+(t.tos[c].name||"")+"</b><span>&lt;"+u[c].value+"&gt;</span><span class=fh>;<span><div></div>";var h="";if(null!=t.ccs[0]&&""!=t.ccs[0])for(var c=0;c<t.ccs.length;c++)h+='<div class="addr-outer"><div class="one" contenteditable="false" data-type="0" data-id="'+f+'"><b>'+(t.ccs[c].name||"")+"</b><span>&lt;"+t.ccs[c].value+"&gt;</span><span class=fh>;<span><div></div>";else h="";$("#sendTheme").attr({"data-id":t.id,"data-emailAddress":t.emailAddress}).val(n),$("#divtxt").prepend(v),UE.getEditor("sendEditor").ready(function(){UE.getEditor("sendEditor").setContent(""),UE.getEditor("sendEditor").setContent(t.content,!0)})}else if(10==m){var g=$.GetQueryString("data");o(g)}}})}};y.signature(),y.addressList(),y.contactsList();var x={head:null,foot:null,type:null,createEditor:function(){var e=[["fontfamily","fontsize","forecolor","backcolor","|","bold","italic","|","underline","formatmatch","insertorderedlist","insertunorderedlist","justifyleft","justifyright","justifycenter","justifyjustify","|","link","unlink","inserttable","fullscreen","cleardoc","emotion"]];x.main=UE.getEditor("sendEditor",{toolbars:e,autoHeightEnabled:!1,initialFrameWidth:"100%",initialFrameHeight:"320"})}};x.createEditor(),$("#added-files").on("click",".removeLi",function(){$(this).parents("li").remove()}),$("#piInput .btn").bind("click",function(){var e=$("#piInput").find("input[type=text]").val();y.insertModelPi(e)}),$("#piInput input").unbind("click").bind("keyup",function(e){if("13"==e.keyCode){var t=$(this).val();y.insertModelPi(t)}}),$("#quoteInput .btn").bind("click",function(){var e=$("#quoteInput").find("input[type=text]").val();y.insertModel3(e)}),$("#quoteInput input[type=text]").unbind("click").bind("keyup",function(e){if("13"==e.keyCode){var t=$(this).val();y.insertModel3(t)}}),$("#added-files").on("click",".previewEml",function(){var e=$(this).parents("li").attr("data-url"),t=$(this).prev().prev().prev().text(),a=e.lastIndexOf("."),n=e.substring(a,e.length).toUpperCase();if(".PNG"==n||".JPG"==n||".JPEG"==n||".SVG"==n||".GIF"==n)var i='<img src="'+e+'" alt="" class="previewImg previewContent">';else if(".TXT"==n||".JS"==n||".CSS"==n)var i='<iframe src="'+e+'" frameborder="0" class="previewIframe previewContent"></iframe>';else{if(".DOC"!=n&&".DOCX"!=n&&".XLS"!=n&&".XLSX"!=n&&".ET"!=n&&".PPT"!=n&&".PPTX"!=n&&".WPS"!=n&&".ZIP"!=n&&".RAR"!=n&&".7Z"!=n&&".PDF"!=n)return void $.Alert(n.toLowerCase()+"格式暂不支持预览");var s=Base.sitUrl+"/api/export/v1/file/preview?data={file: '"+e+"'}",i='<iframe src="'+s+'" frameborder="0" class="previewIframe previewContent"></iframe>'}$("#preview").find("h3").text(t),$("#preview").find(".previewContent").remove(),$("#preview").append(i).show()}),$("#previewClose").on("click",function(){$("#preview").hide().find(".previewContent").remove()}),$("#pdtInput1 .btn").bind("click",function(){var e=$("#pdtInput1").find("input[type=text]").val();y.insertModelPdt(e)}),$("#pdtInput1 input").unbind("click").bind("keyup",function(e){if(13==e.keyCode){var t=$(this).val();y.insertModelPdt(t)}}),$("#pdtGroup").on("change",function(){var e=$(this).find("option:selected").val(),t=$("#pdtInput1").find("input[type=text]").val();y.insertModelPdt(t,e)}),$("#pdtSelect1").on("change",function(){var e=$("#pdtGroup").find("option:selected").val(),t=$(this).find("option:selected").val(),a=$("#pdtInput1").find("input[type=text]").val();y.insertModelPdt(a,e,t)}),$("#pdtSelect2").on("change",function(){var e=$(this).find("option:selected").val(),t=$("#pdtInput1").find("input[type=text]").val();y.insertModelPdt(t,group,e)}),$("#pdtSelect3").on("change",function(){var e=$(this).find("option:selected").val(),t=$("#pdtInput1").find("input[type=text]").val();y.insertModelPdt(t,group,e)}),$("#pdtSelect4").on("change",function(){var e=$(this).find("option:selected").val(),t=$("#pdtInput1").find("input[type=text]").val();y.insertModelPdt(t,group,e)}),$("#pdtSelect1").on("change",function(){var e=$("#pdtSelect1 option:selected").val();$.ajax({url:Base.sitUrl+"/api/product/v1/product/type/sublist?pid="+e,type:"GET",dataType:"json",success:function(t){if(!t.success)return void $.unLogin(t);for(var a=t.data,n="",i=0;i<a.length;i++)n+='<option value="'+a[i].id+'">'+a[i].name+"</option>";$("#pdtSelect2").empty().append('<option value="'+e+'">全部</option>').append(n)}})}),$("#pdtSelect2").on("change",function(){var e=$("#pdtSelect2 option:selected").val();$.ajax({url:Base.sitUrl+"/api/product/v1/product/type/sublist?pid="+e,type:"GET",dataType:"json",success:function(t){if(!t.success)return void $.unLogin(t);for(var a=t.data,n="",i=0;i<a.length;i++)n+='<option value="'+a[i].id+'">'+a[i].name+"</option>";$("#pdtSelect3").empty().append('<option value="'+e+'">全部</option>').append(n)}})}),$("#pdtSelect3").on("change",function(){var e=$("#pdtSelect3 option:selected").val();$.ajax({url:Base.sitUrl+"/api/product/v1/product/type/sublist?pid="+e,type:"GET",dataType:"json",success:function(t){if(!t.success)return void $.unLogin(t);for(var a=t.data,n="",i=0;i<a.length;i++)n+='<option value="'+a[i].id+'">'+a[i].name+"</option>";$("#pdtSelect4").empty().append('<option value="'+e+'">全部</option>').append(n)}})});var k=$(".sentbox-left").height();$(".rightShow, .sentbox-right").height(k-40),$(".rightShow").on("click",function(){var e=$("#addEmailNew").width();if($(".sentbox-right").hasClass("none")){var t=e-220;$(".sentbox-left").animate({width:t+"px"}),$(".sentbox-right").animate({width:"180px",opacity:"1"},"fast").removeClass("none"),$(".leftIcon").css("transform","rotate(90deg)")}else{var a=e-25;$(".sentbox-left").animate({width:a+"px"}),$(".sentbox-right").animate({width:"0",opacity:"0"},"fast").addClass("none"),$(".leftIcon").css("transform","rotate(-90deg)")}});var E=location.href;E.match("showType=right")&&$(".rightShow").click(),m&&y.huifuEmail(),p(),window.saveDraft=function(e){var t=r(12);if(t.flag)return y.operationEmail(t.obj,"/api/email/v1/draft/save")}})});