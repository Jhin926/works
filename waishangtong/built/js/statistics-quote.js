require(["common"],function(){require(["maintab","blockUI","jqform"],function(a){function t(){for(var a=new Date,t=a.getFullYear(),e=(a.getMonth(),""),n="",s=2e3;s<=t;s++)e+="<option value="+s+">"+s+"年</option>";for(var s=1;s<13;s++)n+='<option value="'+s+'">'+s+"月</option>";$("#years").empty(),$("#years").append(e),$("#years").find("option[value="+t+"]").attr("selected",!0),$("#month").empty(),$("#month").append('<option value="0">全部</option>'),$("#month").append(n)}function e(){var a;return $.ajax({url:Base.sitUrl+"/api/quotation/v1/quotation/amount/count",type:"GET",dataType:"json",async:!1,success:function(t){return t.success?void(a=t.data):void $.unLogin(t)}}),a}function n(){for(var a=new Array,t=new Array,e=0;e<r.length;e++)t.push(r[e].month+"月"),a.push(r[e].count);var n=Math.max.apply(null,a),s=Math.round(.2*n);s<1&&(s=1);var i=echarts.init(document.getElementById("chart")),o={tooltip:{trigger:"axis"},legend:{data:["报价单次数"]},xAxis:[{type:"category",axisLabel:{interval:0},data:t}],yAxis:[{type:"value",name:"报价单次数",min:0,max:n,interval:s,axisLabel:{formatter:"{value}"}}],series:[{name:"报价单次数",type:"bar",data:a}]};i.setOption(o)}function s(){for(var a="",t=r.length-1;t>=0;t--)a+='<li class="charTableTitle"><span>'+r[t].year+"年"+r[t].month+"月</span><span>"+r[t].count+"</span></li>";$(".chartTable").empty(),$(".chartTable").append(a),r.length>8&&$("#down").show()}function i(){$.ajax({url:Base.sitUrl+"/api/quotation/v1/quotation/amount/sort",type:"POST",dataType:"json",data:{currentPage:l.currentPage,pageSize:l.pageSize},success:function(a){if(!a.success)return void $.unLogin(a);var t=a.data.results;if(t.length>0){for(var e="",n=0;n<t.length;n++){var s=n+1;e+='<li><span class="circleTop">'+s+"</span><span>"+t[n].name+'</span><span class="moneyTop">'+t[n].count+"</span></li>"}$("#ulLeft").empty().append(e)}else{var i='<img src="../../images/statisticsNone.png">';$("#ulLeft").empty().append(i)}var o=a.data.totalItem,p=o,r=l.pageSize,u=Math.ceil(p/r);l.lastpage=u,$(".i-content-wrapper").stop().animate({scrollTop:0},500)}})}function o(){$.ajax({url:Base.sitUrl+"/api/quotation/v1/quotation/amount/top",type:"POST",dataType:"json",success:function(a){if(!a.success)return void $.unLogin(a);var t=a.data;if(t.length>0){var e="";if(t.length>10)var n=10;else var n=t.length;for(var s=0;s<n;s++){var i=s+1;e+='<li><span class="circleTop">'+i+"</span><span>"+t[s].name+'</span><span class="moneyTop">￥'+t[s].amount+"元</span></li>"}$("#ulRight").empty().append(e)}else{var o='<img src="../../images/statisticsNone.png">';$("#ulRight").empty().append(o)}}})}function p(a,t){var a=a,t=t;$.ajax({url:Base.sitUrl+"/api/quotation/v1/quotation/amount/sort",type:"GET",dataType:"json",data:{currentPage:l.currentPage,pageSize:l.pageSize,year:a,month:t},success:function(a){if(!a.success)return void $.unLogin(a);var t=a.data.results;if(t.length>0){for(var e="",n=0;n<t.length;n++){var s=n+1;e+='<li><span class="circleTop">'+s+"</span><span>"+t[n].name+'</span><span class="moneyTop">'+t[n].count+"</span></li>"}$("#ulLeft").empty(),$("#ulLeft").append(e)}else{var i='<img src="../../images/statisticsNone.png">';$("#ulLeft").empty(),$("#ulLeft").append(i)}var o=a.data.totalItem,p=o,r=l.pageSize,u=Math.ceil(p/r);l.lastpage=u,$(".i-content-wrapper").stop().animate({scrollTop:0},500)}})}var r=e(),l=($(".page-content"),{homepage:1,currentPage:1,lastpage:null,pageSize:10});$("#up a").on("click",function(){$(this).parents(".bodyRight").find("ul li").eq(0).animate({marginTop:"+=40px"},"fast"),$("#down").show(),parseInt($(this).parents(".bodyRight").find("ul li").eq(0).css("marginTop"))>=-40&&$(this).parent().hide()}),$("#down a").on("click",function(){$(this).parents(".bodyRight").find("ul li").eq(0).animate({marginTop:"-=40px"},"fast"),$("#up").show();var a="-"+40*(r.length-6);parseInt($(this).parents(".bodyRight").find("ul li").eq(0).css("marginTop"))<=parseInt(a)&&$(this).parent().hide()}),$("#years").on("change",function(){var a=$(this).val();p(a,0)}),$("#month").on("change",function(){var a=$("#years").val(),t=$(this).val();p(a,t)}),t(),n(),s(),i(),o()})});